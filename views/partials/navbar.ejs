<nav class="navbar">
    <a href="/" class="nav-brand">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px;"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg>
        SkillSwap
    </a>

    <% if (typeof user !== 'undefined' && user) { %>
        <div class="nav-links">
            <a href="/" class="nav-link">Dashboard</a>
            <a href="/my_sessions" class="nav-link">Sessions</a>
            <a href="/messages" class="nav-link">Messages</a>
            
            <% if (user.isAdmin) { %>
                <a href="/admin" class="nav-link" style="color: #b91c1c;">Admin</a>
            <% } %>
            
            <div class="nav-user">
                <span style="font-size: 0.9em; font-weight: bold; margin-right:5px;"><%= user.name %></span>
                
                <a href="/profile/view/<%= user.id %>" title="View Profile">
                    <img src="https://api.dicebear.com/7.x/<%= user.avatarStyle || 'bottts' %>/svg?seed=<%= user.name %>" class="nav-avatar" alt="Avatar">
                </a>
                
                <button onclick="handleLogout()" style="background:none; border:none; cursor:pointer; font-size:1.2em; padding: 5px;" title="Log Out">ðŸšª</button>
            </div>
        </div>
    <% } else { %>
        <div class="nav-links">
            <a href="/login" class="nav-link">Log In</a>
            <a href="/register" class="nav-link" style="background-color: var(--primary-color); color: white; padding: 8px 15px; border-radius: 6px;">Sign Up</a>
        </div>
    <% } %>
</nav>

<script>
    async function handleLogout() {
        if (!confirm("Are you sure you want to log out?")) return;
        try {
            const response = await axios.post('/api/logout');
            if (response.status === 200) window.location.href = '/'; 
        } catch (error) {
            console.error('Logout Failed:', error);
            alert('Logout failed.');
        }
    }
</script>